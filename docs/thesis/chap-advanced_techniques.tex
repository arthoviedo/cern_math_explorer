\chapter{Further Data Analysis}
\label{chap-data_analysis}

In parallel to the development of $5e^{x+y}$ we perform some analysis over our datasets to have a better understanding of the data. Even though this series of analysis did were not directly introduced into the codebase of the system, they provide valuable insights and allowed us to identify future directions of work.

\section{Clustering}

We used Apache Mahout v0.9 for performing the clustering task. 
The following set of commands were used to create and analyse our dataset:

To convert the solr index to a mahout compatible format (Mahout vector):

\small{{\codefont ./mahout lucene.vector -d <path to solr index>  -o ../results/vectors -t ../results/dict -f math           \_notational\_field -st ../results/dict\_seq -x 20 -md 2 -w TFIDF -n 2}}

To run the canopy clustering on the data:

\small{{\codefont ./mahout canpoy -t1 0.15 -t2 0.1 -i ../results/vectors -o ../results/clustering/canopy -dm org.apache.mahout.common.distance.CosineDistanceMeasure}}

To run k-means algorithm on the resulting canopies:

\small{{\codefont ./mahout kmeans -i ../results/vectors -o ../results/clustering\_kmeans -xm sequential  -c ../results/clustering/canopy -x 50 -cd 0.1 -cl -dm org.apache.mahout.common.distance.CosineDistanceMeasure}}

To get the resulting points with their assigned cluster in a human readable format:
\small{{\codefont ./mahout seqdumper -i ../results/clustering\_kmeans/clusteredPoints/part-m-0 > ../results/clustering\_kmeans/clusteredPoints/cluster-points.txt}}

Since the estimation of a good number of clusters k is a challenging task, we also tried to estimate it  by evaluating intra and inter cluster distances for different values of k. Table \ref{cluster_measurements} shows that around k=500 the inter-cluster distance begins to remain stable and by increasing k to 1024, its value is affected only by less than 1\% indicating that a good k number is around 500.

\begin{longtable}{|c|c|c|}
\hline 
\textbf{K} & \textbf{Average Intra-cluster distance} & \textbf{Average Inter-cluster distance} \\ 
\hline 
2 & 0.916 & 0.376  \\ \hline 
4 & 0.907 & 0.557  \\ \hline 
8 & 0.881 & 0.538  \\ \hline 
16 & 0.859 & 0.628  \\ \hline 
32 & 0.818 & 0.781  \\ \hline 
64 & 0.772 & 0.833  \\ \hline 
128 & 0.732 & 0.910  \\ \hline 
256 & 0.694 & 0.938  \\ \hline 
512 & 0.655 & 0.955  \\ \hline 
1024 & 0.610 & 0.963  \\ \hline 
\caption{Cluster measurements for different values of k}
\label{cluster_measurements}
\end{longtable} 

The resulting clusters can help us to identify common structures and further improve our results by either adding frequent structures that are common to a cluster, or by reducing the number of elements to perform comparisons against and allow to speed-up the querying process.
Table \ref{} shows the top terms in 2 different clusters that were identified. By simple inspection, it is possible to identify the first one as a cluster grouping trigonometric expressions (Sines and Cosines) and the second one grouping limits where the variable goes to infinity.

{\footnotesize
\begin{longtable}{|>{\centering\arraybackslash}m{3.5cm}c|>{\centering\arraybackslash}m{3.5cm}c|}
\hline 
\textbf{Term} & \textbf{Relative frequence} & \textbf{Term} & \textbf{Relative frequence} \\ 
\hline 
<mi>cos</mi> <mo></mo>	&0.163661208&		<mi>∞</mi>&	0.233151718\\ \hline 
<mi>cos</mi>&	0.157439621	&	<mo>→</mo> <mi>∞</mi>&	0.108867782\\ \hline 
<mo></mo>&	0.121893736&		<mo>→</mo>&	0.108017583\\ \hline 
<mi>$\theta$</mi>&	0.097241797&		<mo>ARROWS</mo>&	0.105854015\\ \hline 
<mo></mo> <mi>$\theta$</mi>&	0.095168449&		<mo>-</mo> <mi>∞</mi>&	0.105012368\\ \hline 
<mrow> <mi>cos</mi> <mo>⁡</mo> <mi>$\theta$</mi> </mrow>&	0.088535288&		<mrow> <mo>-</mo> <mi>∞</mi> </mrow>&	0.102411785\\ \hline 
<mi>cos</mi> <mo></mo> <mi>θ</mi> &	0.088535288&		<mrow> <mo>+</mo> <mi>∞</mi> </mrow>&	0.055650946\\ \hline 
<mi>sin</mi> <mo></mo>&	0.068049679&		<mo>+</mo> <mi>∞</mi>&	0.055490528\\ \hline 
<mi>sin</mi>&	0.066531563&		<mrow> <mrow> <mo>-</mo> <mi>∞</mi> </mrow>&	0.043459138\\ \hline 
<mrow> <mi>sin</mi> <mo></mo> <mi>θ</mi> </mrow>&	0.032338911&		<mo>,</mo> <mi>∞</mi> & 0.021523067\\ \hline 
<mi>sin</mi> <mo></mo> <mi>$\theta$</mi> &	0.032338911&		<mrow> <mo>(</mo> <mrow> <mrow> <mo>-</mo> <mi>∞</mi> </mrow> &	0.020583379\\ \hline 
<mi>$\phi$</mi>&	0.031248212&		<mi>t</mi> <mo>→</mo>&	0.016400033\\ \hline 
<mi>$\Phi$</mi>&	0.019359824&		<mrow> <mo>[</mo> <mrow> <mrow> <mo>-</mo> <mi>∞</mi> </mrow>& 0.01478247\\ \hline 
<mi></mi>&	0.018438684&		<mi>t</mi>&	0.014620022\\ \hline 
<mo></mo> <mi>$\Phi$</mi> & 0.017617149 & <mrow> <mo>$\pm$</mo > <mi>∞</mi> </mrow> & 0.014477746\\ \hline 
<mrow> <mrow> <mi>cos</mi> <mo></mo> <mi>θ</mi> </mrow>&	0.016889963& <mo>$\pm$</mo> <mi>$\infty$</mi>& 0.014348642\\ \hline 
<mi>cos</mi> <mo></mo> <mi>$\Phi$</mi>&	0.016157276	&	<mo>|</mo>&	0.012372129\\ \hline 
<mrow> <mi>cos</mi> <mo></mo> <mi>$\Phi$</mi> </mrow> &	0.016157276	&	<mo>lim</mo>&	0.012214223\\ \hline 
<mo>$\phi$</mo>&	0.015344056 &		<mi>C</mi>	& 0.010421859\\ \hline 
<mi>$\alpha$</mi>&	0.014598769 &		<mo>$\in$</mo>	& 0.009871146\\ \hline 


\caption{Top 20 terms for two different identified clusters }
\label{cluster_measurements}
\end{longtable} 
}

\section{Latent Dirichlet Allocation with Apache Mahout}

